function [x,y] = board2ball(a,b,L,q,lam)
k = 9e9;

x = k.*(a.^4+2.*a.^2.*(b+(-1).*L).*(b+L)+(b.^2+L.^2).^2).^(-1/2).*(( ...
  -1).*(b.^2+(a+(-1).*L).^2).^(1/2)+(b.^2+(a+L).^2).^(1/2)).*lam.*q; 
y = b.^(-1).*k.*(a.*((-1).*(b.^2+(a+(-1).*L).^2).^(-1/2)+(b.^2+(a+L) ...
  .^2).^(-1/2))+L.*((b.^2+(a+(-1).*L).^2).^(-1/2)+(b.^2+(a+L).^2).^( ...
  -1/2))).*lam.*q;

%y = k.*lam.*q.*a.*(1./r+(L-a)./sqrt(b.^2+(L-a).^2))./b;
x(max((a<-L),(a>L))) = 0;
x(max((b<0),(b>L))) = 0;
y(max((a<-L),(a>L))) = 0;
y(max((b<0),(b>L))) = 0;
end